<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
</head>

<body>
<h2>Future</h2>

<p>
Up: <a href=".">Learn</a>,
Prev: <a href="updates">Updates</a>.
</p>

<br></br>


<h1>Referencing the future</h1>

<p>
Now that we have seen how to update block definitions,
for our final tutorial,
we will look into a complementary capability,
making references to the future!
We will need our trusty Goat Pen:
</p>

<textarea class="codebox" style="min-height: 100px; width: 95%"></textarea>

<p>
The code for this demonstration is below.
</p>

<pre>
myPlane = {.z = .x - .y + 7};
myPointDepth = myPlane(.x : 1, .y : 2).z;
.inspect = myPointDepth;
</pre>

<p>
Okay, let's see what this does!
Type it into the Goat Pen and run it.
The depth of the point should be:
</p>

<pre>
6.0
</pre>

<h4>How it looks and what it means</h4>

<p>
For a final time,
let's consider the annotated program below and discuss some interesting parts.
<pre>
1 | myPlane = {.z = .x - .y + 7};
                    ^^^^^^^^^^^
                    1
2 | myPointDepth = myPlane(.x : 1, .y : 2).z;
                   ^^^^^^^^^^^^^^^^^^^^^^^
                   2                      ^^
                                          3
3 | .inspect = myPointDepth;
</pre>
<ol>
<li>
Probably the most notable part of the program is the definition of the name <code>z</code> inside the block defining <code>myPlane</code>.
<code>z</code> is defined as a mathematical expression where two of the inputs are <code>.</code> prefixed names <code>x</code> and <code>y</code>,
for which there are no corresponding definitions!
How can this be?
We need to consider the next line.
</li>
<li>
The definition made to <code>myPointDepth</code> shows how we can use <code>myPlane</code> in a sensible way.
We just need to update it with the missing definitions!
</li>
<li>
We don't have to name the updated value we have created,
instead we can immediately access the "z" component and assign that as the definition for <code>myPointDepth</code>.
Running the program shows that this evaluates to 7.0,
illustrating the program behaviour â€”
the provided "x" and "y" component values are substituted into the definition for the "z" component of <code>myPlane</code>.
</li>
</ol>
</p>

<h4>Live names</h4>

<p>
The vital component making this exercise work is the use of <code>.</code> prefixed names
(i.e. <code>.x</code> and <code>.y</code>)
in the "z" component definition of <code>myPlane</code>.
Without the prefix, we would get missing definition errors (try it!),
since we haven't defined the names.
When we use the <code>.</code> prefix we get a "live" reference to the corresponding component of the block,
that updates whenever the corresponding component updates.
The Goat interpreter will wait until the block's "z" component is accessed,
and first access the "x" and "y" components and substitute them into the "z" definition.
</p>

<p>
Values like <code>myPlane</code> that are only partially defined act as templates from which complete values can be made by updating.
After providing "x" and "y" components to <code>myPlane</code>, we can safely access the "z" component in the definition of <code>myPointDepth</code>. 
Goat will help us by checking that we only try to access completed components.
I.e. we get an error if we try to acccess the "z" component of <code>myPlane</code>,
without first updating to provide the missing components (try it too!).
</p>

<h4>The journey continues...</h4>

<p>
We have now completed a basic tour of how Goat reads and is written.
For those of you whose curiosity has been piqued,
now might be time to try some <a href="../examples">Examples</a>.
</p>

<script src="../script/setup-goat-web.js"></script>
<script src="../script/goat-web.js"></script>
</body>
</html>
