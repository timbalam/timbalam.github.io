<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="../style.css">
</head>

<body>
<header>
<p>
Prev: <a href="names">Names</a>,
Next: <a href="shadows">Shadows</a>,
Up: <a href=".">Learn</a>
</p>
</header>
<hr>
<main>
<h1>Names, layered</h1>

<p>
In the <a href="names">previous tutorial</a> we created a value representing a 2-D point.
A useful generalisation of this would be to have the y-component relate to the x-component â€“
i.e. a line.
Let's try to do this.
First, below is our Goat pen.
</p>

<textarea class="codebox"></textarea>

<p>
We can generalise our previous example,
and modify the definition of <code>myPoint</code> so that the y-coordinate relates to the x- by the line <strong>y = x + 2</strong>.
The new program is shown below.
</p>

<pre class="codebox">
myLine = { .x = 2; .y = x + 2 };
.inspect = myLine.y;
</pre>

<p>
Let's go ahead and replace our code in the Goat Pen with this and run it.
You should see the following.
</p>

<pre class="codebox-output">
4.0
</pre>

<h4>Creating layers</h4>

<p>
It worked!
But how?
As suggested by the reuse of assignment syntax,
one way to think of blocks is as defining a sub-program.
At the end of the <a href="maths">Math</a> tutorial,
we described a way of looking at Goat programs as a set of names.
With blocks,
we don't need to settle for a single set of names for our entire program.
They introduce a new "layer" of names,
existing within the <code>{}</code> and allowed to overlap with outer layers.
(Names within a layer must still be unique, though.)
</p>

<h4>Going local</h4>

<p>
Like the main definitions of our programs,
within blocks we have the option of defining names without the <code>.</code> prefix.
An important thing to note is that within a block,
component definitions not treated specially.
We can use the name <code>x</code> unprefixed in the definition of <code>.y</code>,
even though we used the prefix <code>.</code> when defining the component.
The difference is that only components be accessed directly by code outside the block,
as the in definition of <code>.inspect</code>.
We call definitions that are not components "local".
</p>

<p>
Aside: The special <code>.inspect</code> assignment we may recognise as having the <code>.</code> prefix,
making it a program-level component.
We won't get to cover exactly what this means in these tutorials, though.
</p>

<p>
You can observe the difference in behaviour between components and local names with the following exercise.
First, remove the <code>.</code> prefix of the <code>.x</code> definition of <code>myLine</code>.
You should find the result doesn't change,
since the only reference to <code>x</code> is within the block definition.
Now try removing the <code>.</code> prefix of the <code>.y</code> definition.
Due to the attempt to access the component by <code>.inspect</code>,
you should now get an error like the following:
</p>
<pre class="codebox-output">
&lt;error: Missing component: y&gt;
</pre>

</main>
<hr>
<footer>
<p>
Prev: <a href="names">Names</a>,
Next: <a href="shadows">Shadows</a>,
Up: <a href=".">Learn</a>
</p>
</footer>

<script src="../script/setup-goat-web.js"></script>
<script src="../script/goat-web.js"></script>
</body>
</html>
